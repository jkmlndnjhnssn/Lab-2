<html lang="en-UK">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/4.9.1/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyBv11W6MmP2Tb4twpU7l8iK_zGVJQu0VFg",
    authDomain: "fir-1-befd8.firebaseapp.com",
    databaseURL: "https://fir-1-befd8.firebaseio.com",
    projectId: "fir-1-befd8",
    storageBucket: "fir-1-befd8.appspot.com",
    messagingSenderId: "503520093961"
  };
  firebase.initializeApp(config);
</script>
    
    <style>
        
    </style>
    
</head>


<body>

    <h1>Firebase labb 2</h1>

    
    
    <script>  
        
        
           let provider = new firebase.auth.GithubAuthProvider();
        provider.setCustomParameters({  // optional
          'allow_signup': 'true'
        });
        firebase.auth().getRedirectResult().then(function(result) {
            // Om vi har gjort en redirect tidigare,
            // så är result.user !== null
            if( result.user ) {
                console.log('Redirect result, success: we have a user.');
                console.log('You are logged in as ' + firebase.auth().currentUser.displayName);
                fetchFromDatabase();
            } else {
                console.log('Redirect result, user is null.');
            }
        })
        .catch(function(error) {
            // Inträffar om vi inte kan få information om en
            // eventuell tidigare redirect
            console.log('Redirect result, error: ' + error.message);
        })
        window.addEventListener('load', function() {
            // Klicka på knappen för att logga in med redirect
            document.getElementById('redirectButton').addEventListener('click', function(e) {
                firebase.auth().signInWithRedirect(provider);
            });
            document.getElementById('popupButton').addEventListener('click', function(e) {
                firebase.auth().signInWithPopup(provider).then(function(result) {
                    var user = result.user;
                    console.log('Popup result: logged in as ', user.displayName);
                    fetchFromDatabase();
                }).catch(function(error) {
                    console.log('Popup result, error: ' + error.message);
                });
            });
            document.getElementById('signoutButton').addEventListener('click', function(event) {
                firebase.auth().signOut().then(function(result) {
                    console.log('Signed out user');
                })
                .catch(function(error) {
                    console.log('Signout failed');
                })
            })
        }) 

    </script> 
    <button id="redirectButton">Redirect authentication</button>
	<button id="popupButton">Popup authentication</button>
	<button id="signoutButton">Sign out user</button>
</body>
</html>